<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="menu">

	<!-- 메뉴 리스트 불러오기 -->
	<select id="selectMenuList" parameterType="hashmap" resultType="hashmap">
			SELECT MENU_ID
				   ,UPPR_MENU_ID
				   ,MENU_NAME
				   ,WRITER_ID
				   ,ORDR
				   ,INSRT_DT
				   ,UPDT_DT
			FROM MENU
			START WITH UPPR_MENU_ID IS NULL
			CONNECT BY PRIOR MENU_ID = UPPR_MENU_ID
			ORDER SIBLINGS BY ORDR	
	</select>
	
	<!-- 메뉴 리스트 등록하기 -->
	<insert id="insertMenu" parameterType="hashmap" useGeneratedKeys="true" keyProperty="NOTICE_NO">
		<selectKey keyProperty="MENU_ID" resultType="string" order="BEFORE">
			SELECT MENU_ID_SEQ.NEXTVAL FROM DUAL
		</selectKey>
		<![CDATA[
			INSERT INTO MENU
			(
				 MENU_ID
				 ,UPPR_MENU_ID
				 ,MENU_NAME
				 ,WRITER_ID
				 ,ORDR
				 ,INSRT_DT
			)
			VALUES
			(
				#{NOTICE_NO}
				,#{upprMenuId}
				,#{menuname}
				,#{writerId}
				,#{ordr}
				,SYSDATE
			)
		]]>
	</insert>
	
	
	<!-- 메뉴 상세페이지 불러오기 -->
	<select id="selectMenuDetail" parameterType="hashmap" resultType="hashmap">
			SELECT 
				NOTICE_NO,
				NOTICE_TITLE,
				NOTICE_CONTENT,
			FROM 
				NOTICE
			WHERE
				NOTICE_NO = #{NOTICE_NO},
	</select> 
	
	<!-- 메뉴 답변 수정하기 -->
	<update id="updateMenu" parameterType="hashmap">
			UPDATE NOTICE
			SET
				NOTICE_TITLE = #{NOTICE_TITLE}, 
				NOTICE_CONTENTS = #{NOTICE_CONTENTS}
			WHERE
				NOTICE_NO = #{NOTICE_NO}
	</update>
	
	<!-- 메뉴 삭제하기 -->
	<delete id="deleteMenu" parameterType="hashmap">
			DELETE FROM NOTICE
			WHERE 
				NOTICE_NO = #{NOTICE_NO}
	</delete>

</mapper>